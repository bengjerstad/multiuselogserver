<!DOCTYPE html>
<html>
<head>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
<script>
SERVERIP = '10.24.25.130';

$(document).ready(function(){

    $("#getdup").click(function(){
        $.getJSON("http://"+SERVERIP+":8000/get_dup", function(result){
			$("#main").html('');
			$.each( result, function( key, val ) {
				username = key.split(" ")[0];
				link = "<a href='#' class='dupitem'>"+username+ "</a>"
				$("#main").append("<li>"+link+"</li>");
			});
			$(".dupitem").click(function(){
				username = $(this).text();
				$(".selected").removeClass( "selected" );
				$(this).addClass( "selected" );
				$("#exusername").val(username);
				$.getJSON("http://"+SERVERIP+":8000/get_log?username="+username+"&compname=all", function(result){
					$("#logview").html("");
					$("#logview").append("<table>");
					$.each( result, function( key, val ) {
					datetime = val.time;
					datetime = datetime.split("_");
					date = datetime[0].split("-");
					date[0] = date[0].substring(1, 5);
					date = date[1]+"/"+date[2]+"/"+date[0];
					timeh = datetime[1].substring(0, 2);
					timem = datetime[1].substring(2, 4);
						$("#logview").append("<tr><td>"+val.username+" </td><td> "+val.compname+" </td><td> "+val.stat+" </td><td> "+timeh+":"+timem+" </td><td> "+date+" </td></tr>");
					});
				});
				
				
			});
        });
    });
	 $("#getex").click(function(){
        $.getJSON("http://"+SERVERIP+":8000/ex_this?username=none&action=list&lvl=none", function(result){
			$("#exlist").html("");
			$.each( result, function( key, val ) {
				username = val.username;
				$("#exlist").append("<li>"+username+ "</li>");
			});
        });
    });
		 $("#addex").click(function(){
		 un = $("#exusername").val();
        $.getJSON("http://"+SERVERIP+":8000/ex_this?username="+un+"&action=add&lvl=none", function(result){
			username = result
			$("#exlist").append("<li>"+username+ "</li>");
        });
    });

});
</script>
<style>
ul {
  list-style-type: none;
}
div{
	float:left;
	max-width:49%;
	width:15em;
	height:100%;
	position: relative;
}
td{
	padding: .5em;
	border-bottom: 1px solid #ddd;
}
.selected{
	background-color: #cccccc;
}
a:link {
    text-decoration: none;
}

a:visited {
    text-decoration: none;
}

a:hover {
    text-decoration: underline;
	background-color: #eeeeee;
}

a:active {
    text-decoration: underline;
	background-color: #cccccc;
}
</style>
</head>
<body>
<ul>

<!--
<li><a href="#" id="getlog">Get Log</a> Username:<input id="username" value="all"/> Computername:<input id="compname" value="all"/></li>
<li><a href="#" id="getex">Clear Entire Log</a></li>

<li><a href="#" id="clearex">Clear Exclusion List</a></li>

-->
<div id="leftpan" style="float:left;">
<li><a href="#" id="getdup">Get Duplicates</a></li>
<div id="main"></div>
</div>
<div id="logview" style="width:30em;"></div>
<div id="rightpan" style="float:right;">
<ul id="exnav" style="width:100%;">
		<li><a href="#" id="getex" >Get Exclusion List</a></li>
		<li><input id="exusername"/><br/><a href="#" id="addex">Add to Exclusion List</a><li>
	</ul>
<div id="exlist">
</div>
</body>
</html>
	
